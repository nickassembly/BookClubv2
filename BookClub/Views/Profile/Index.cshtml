@using System.Web;
@using BookClub.Data.Entities.User

@model LoginUserProfileViewModel

@{
    ViewData["Title"] = "User Profile";
}

<div class="m-2">
    <h1>Authors' News and Events</h1>
    <p>User's Author News feed goes here, social media statements, articles, etc. Imagining front page of reddit</p>
    <p>button brings to a new page to list authors being followed, add/remove etc. </p>
    <button type="button" class="btn btn-success">Edit Author News Options</button>
</div>

<div class="m-2">
    <h1>Series You Follow</h1>
    <p>Same for Book Series</p>
    <button type="button" class="btn btn-success">Edit Series News Options</button>
</div>

<div class="m-2">
    <h1>Users Feed</h1>
    <div class="m-2">
        <ul>
            @if (Model.Friends.Count > 0)
            {
                @for (var i = 0; i < Model.Friends.Count(); i++)
                {
                    <li>@Model.Friends[i]</li>
                }
            }
        </ul>
    </div>

    <div class="form-inline">
        <input class="form-control mr-sm-2" type="text" id="searchParam" name="searchInput" placeholder="Search Users" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" onclick="searchUsers($('#searchParam').val())" type="submit">Submit</button>
    </div>
</div>

<div class="bs-example">
    <!-- Modal HTML -->
    <div id="noteModal" class="modal fade" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Friends</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                </div>
            </div>
        </div>
    </div>
</div>


<style>
    .bs-example {
        margin: 20px;
    }
</style>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

<script type="text/javascript">

    function searchUsers(searchParam) {
      console.log(searchParam);

      // TODO: call action
      $.ajax({
       contentType: 'application/json; charset=utf-8',
       dataType: 'json',
       type: 'POST',
       url: '/Account/SearchUsers/' + searchParam,
       data: searchParam,
       success: function() {
           window.location.href="url";
           console.log("ajax Notes post called");
       },
       failure: function(response) {
           console.log(response);
       },
       beforeSend: function (xhr) {
                     xhr.setRequestHeader("XSRF-TOKEN",
                     $('input:hidden[name="__RequestVerificationToken"]').val());
                    }
        });
        
        // TODO: show modal with data retrieved from action
           $("#noteModal").modal("show");

    }

</script>

